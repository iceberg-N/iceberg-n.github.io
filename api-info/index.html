{"posts":[{"fileName":"impacket-get-gpppassword-qian-xi","abstract":"<h1 id=\"impacket-get-gpppassword浅析\">impacket -- Get-GPPPassword浅析</h1>\n","description":"impacket -- Get-GPPPassword浅析 简介 作用： 可用于转储组策略首选项密码。与其他类似工具不同的是，该实用程序不会从 DC 挂载远程 SYSVOL 共享，而是使用流来导航共享并刻录文件内容。 实验环境 win20...","title":"impacket -- Get-GPPPassword浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-get-gpppassword-qian-xi/","stats":{"text":"4 min read","time":221000,"words":741,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#impacket-get-gpppassword%E6%B5%85%E6%9E%90\">impacket -- Get-GPPPassword浅析</a>\n<ul>\n<li><a href=\"#%E7%AE%80%E4%BB%8B\">简介</a>\n<ul>\n<li><a href=\"#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83\">实验环境</a></li>\n</ul>\n</li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90\">代码分析</a>\n<ul>\n<li><a href=\"#%E5%9C%A8%E7%BA%BF\">在线</a>\n<ul>\n<li><a href=\"#%E5%BB%BA%E7%AB%8Bsmb%E8%BF%9E%E6%8E%A5\">建立SMB连接</a></li>\n<li><a href=\"#%E5%88%97%E5%87%BA%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9\">列出共享文件夹</a></li>\n<li><a href=\"#%E5%AF%BB%E6%89%BE%E5%AF%86%E7%A0%81\">寻找密码</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-15 16:54:29","dateFormat":"2023-11-15"},{"fileName":"impacket-finddelegation-qian-xi","abstract":"<h1 id=\"impacket-finddelegation浅析\">impacket -- findDelegation浅析</h1>\n","description":"impacket -- findDelegation浅析 简介 作用： 找出AD域环境中所有的委托关系(非约束性委派、约束性委派、基于资源的约束性委派) 实验环境 win2019(域控)：192.168.1.137 win10(攻击机)：...","title":"impacket -- findDelegation浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-finddelegation-qian-xi/","stats":{"text":"2 min read","time":115000,"words":395,"minutes":2},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#impacket-finddelegation%E6%B5%85%E6%9E%90\">impacket -- findDelegation浅析</a>\n<ul>\n<li><a href=\"#%E7%AE%80%E4%BB%8B\">简介</a>\n<ul>\n<li><a href=\"#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83\">实验环境</a></li>\n</ul>\n</li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90\">代码分析</a></li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-15 16:53:21","dateFormat":"2023-11-15"},{"fileName":"impacket-dumpntlminfo-qian-xi","abstract":"<h1 id=\"impacket-dumpntlminfo浅析\">impacket -- DumpNTLMinfo浅析</h1>\n","description":"impacket -- DumpNTLMinfo浅析 简介 作用： 在 ntlm 身份验证模型中转储远程主机信息，无需凭据； 方式： SMB、RPC； 测试环境 win2019(被攻击机)：192.168.1.137 win10(攻击机)...","title":"impacket -- DumpNTLMinfo浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-dumpntlminfo-qian-xi/","stats":{"text":"4 min read","time":201000,"words":679,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#impacket-dumpntlminfo%E6%B5%85%E6%9E%90\">impacket -- DumpNTLMinfo浅析</a>\n<ul>\n<li><a href=\"#%E7%AE%80%E4%BB%8B\">简介</a>\n<ul>\n<li><a href=\"#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83\">测试环境</a></li>\n</ul>\n</li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90\">代码分析</a>\n<ul>\n<li><a href=\"#smb\">SMB</a>\n<ul>\n<li><a href=\"#smb%E5%8D%8F%E5%95%86\">SMB协商</a></li>\n<li><a href=\"#smb-v1%E7%89%88%E6%9C%AC%E6%94%AF%E6%8C%81%E6%A3%80%E6%B5%8B\">SMB V1版本支持检测</a></li>\n<li><a href=\"#smb%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81\">SMB身份验证</a></li>\n<li><a href=\"#smb%E5%8C%BF%E5%90%8D%E8%AE%BF%E9%97%AE\">SMB匿名访问</a></li>\n</ul>\n</li>\n<li><a href=\"#rpc\">RPC</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-15 16:51:07","dateFormat":"2023-11-15"},{"fileName":"impacket-dcomexec-qian-xi","abstract":"<h1 id=\"dcomexec-浅析\">dcomexec 浅析</h1>\n","description":"dcomexec 浅析 简介 作用： 利用DCOM接口进行命令执行； 条件： 关闭防火墙 域内高权限账户 测试环境 DC(域控)：192.168.1.137 win10(攻击机)：192.168.1.129 win7(被攻...","title":"impacket -- dcomexec浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-dcomexec-qian-xi/","stats":{"text":"6 min read","time":308000,"words":1015,"minutes":6},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#dcomexec-%E6%B5%85%E6%9E%90\">dcomexec 浅析</a>\n<ul>\n<li><a href=\"#%E7%AE%80%E4%BB%8B\">简介</a>\n<ul>\n<li><a href=\"#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83\">测试环境</a></li>\n</ul>\n</li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90\">代码分析</a></li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-14 15:09:41","dateFormat":"2023-11-14"},{"fileName":"impacket-dpadpi-qian-xi","abstract":"<h1 id=\"dpadpi浅析\">dpadpi浅析</h1>\n","description":"dpadpi浅析 简介 作用： 获取Master Key，或者通过Master Key解密DPAPI 条件： 无需凭据，提供目标地址即可； DPAPI DPAPI是一个提供数据保护服务的Windows API；主要用于加密解密数据； DP...","title":"impacket -- dpadpi浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-dpadpi-qian-xi/","stats":{"text":"16 min read","time":901000,"words":3346,"minutes":16},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#dpadpi%E6%B5%85%E6%9E%90\">dpadpi浅析</a>\n<ul>\n<li><a href=\"#%E7%AE%80%E4%BB%8B\">简介</a>\n<ul>\n<li><a href=\"#dpapi\">DPAPI</a></li>\n<li><a href=\"#master-key\">Master Key</a>\n<ul>\n<li><a href=\"#%E8%A7%A3%E5%AF%86master-key\">解密Master Key</a>\n<ul>\n<li><a href=\"#%E5%9C%A8%E7%BA%BF%E8%8E%B7%E5%BE%97%E6%98%8E%E6%96%87-master-key\">在线获得明文 Master Key</a></li>\n<li><a href=\"#%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%AF%86%E7%94%A8%E6%88%B7-master-key\">在线解密用户 Master Key</a></li>\n<li><a href=\"#%E5%AF%BC%E5%87%BA-lsass-%E5%86%85%E5%AD%98%E8%8E%B7%E5%BE%97%E6%98%8E%E6%96%87%E7%94%A8%E6%88%B7-master-key\">导出 lsass 内存获得明文用户 Master Key</a></li>\n<li><a href=\"#%E5%AF%86%E7%A0%81%E8%A7%A3%E5%AF%86%E7%94%A8%E6%88%B7-master-key\">密码解密用户 Master Key</a></li>\n<li><a href=\"#%E7%88%86%E7%A0%B4%E7%94%A8%E6%88%B7-master-key-%E5%AF%86%E7%A0%81\">爆破用户 Master Key 密码</a></li>\n<li><a href=\"#%E5%9F%9F%E5%A4%87%E4%BB%BD%E5%AF%86%E9%92%A5%E8%A7%A3%E5%AF%86%E7%94%A8%E6%88%B7-master-key\">域备份密钥解密用户 Master Key</a></li>\n<li><a href=\"#%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%A7%A3%E5%AF%86%E7%B3%BB%E7%BB%9F-master-key\">注册表解密系统 Master Key</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#blob\">Blob</a></li>\n<li><a href=\"#credential\">Credential</a></li>\n<li><a href=\"#vault\">Vault</a></li>\n<li><a href=\"#credhist\">Credhist</a></li>\n<li><a href=\"#preferred\">Preferred</a></li>\n<li><a href=\"#cryptoapi\">CryptoAPI</a></li>\n<li><a href=\"#cng\">CNG</a></li>\n<li><a href=\"#wlan-%E5%87%AD%E6%8D%AE\">WLAN 凭据</a>\n<ul>\n<li><a href=\"#%E4%B8%AA%E4%BA%BA\">个人</a></li>\n<li><a href=\"#%E4%BC%81%E4%B8%9A\">企业</a></li>\n</ul>\n</li>\n<li><a href=\"#chrome-%E5%87%AD%E6%8D%AE-cookie\">Chrome 凭据 &amp; Cookie</a></li>\n<li><a href=\"#edge-%E5%87%AD%E6%8D%AE-cookie\">Edge 凭据 &amp; Cookie</a></li>\n</ul>\n</li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90\">代码分析</a>\n<ul>\n<li><a href=\"#masterkey\">masterkey</a>\n<ul>\n<li><a href=\"#%E7%A6%BB%E7%BA%BF\">离线</a></li>\n<li><a href=\"#%E5%9C%A8%E7%BA%BF\">在线</a></li>\n</ul>\n</li>\n<li><a href=\"#backupkeys\">BACKUPKEYS</a></li>\n<li><a href=\"#credential-2\">CREDENTIAL</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a>\n<ul>\n<li><a href=\"#%E6%9B%B4%E6%94%B9smb%E5%8D%8F%E5%95%86%E7%89%88%E6%9C%AC\">更改SMB协商版本</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-14 14:59:55","dateFormat":"2023-11-14"},{"fileName":"impacket-jie-du-atexec-qian-xi","abstract":"<h1 id=\"atexec-浅析\">atexec 浅析</h1>\n<hr>\n","description":"atexec 浅析 测试环境 作用： 利用计划任务组件进行命令执行； 方式： SMB协议，NamePipe\\atsvc接口； 内网环境 DC(域控)：192.168.1.137 WIN10(攻击机)：192.168.1.129 WIN...","title":"impacket解读 -- atexec浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-jie-du-atexec-qian-xi/","stats":{"text":"6 min read","time":344000,"words":1062,"minutes":6},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#atexec-%E6%B5%85%E6%9E%90\">atexec 浅析</a>\n<ul>\n<li><a href=\"#%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83\">测试环境</a></li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90\">代码解析</a></li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-12 19:44:54","dateFormat":"2023-11-12"},{"fileName":"impacket-jie-du-addcomputer-qian-xi","abstract":"<h1 id=\"addcomputer-浅析\">addcomputer 浅析</h1>\n","description":"addcomputer 浅析 作用：域内创建机器账户； 方法：samr(默认)、ldap； SAMR RPC绑定 ​ epm.hept_map()方法进行前期的RPC绑定以及EPM MAP请求操作 if self.__targetIp ...","title":"impacket解读 -- addcomputer浅析","tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/"},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/impacket-jie-du-addcomputer-qian-xi/","stats":{"text":"4 min read","time":191000,"words":702,"minutes":4},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#addcomputer-%E6%B5%85%E6%9E%90\">addcomputer 浅析</a>\n<ul>\n<li><a href=\"#samr\">SAMR</a>\n<ul>\n<li><a href=\"#rpc%E7%BB%91%E5%AE%9A\">RPC绑定</a></li>\n<li><a href=\"#rpc%E8%B0%83%E7%94%A8\">RPC调用</a></li>\n</ul>\n</li>\n<li><a href=\"#ldap\">LDAP</a></li>\n<li><a href=\"#%E6%80%BB%E7%BB%93\">总结</a></li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-10 11:47:29","dateFormat":"2023-11-10"},{"fileName":"rpc","abstract":"","description":"RPC 基础知识 建立RPC服务 ​ 当建立RPC Server时，会向EPM服务器注册相关信息，这些信息会存储在epm服务器的端点映射数据库中，rpc发现过程中也是查询端点映射数据库中的信息返回给client； ​ 一般每个wind...","title":"MS-RPC -- RPC基础知识","tags":[{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/"},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/"}],"feature":"","link":"https://iceberg-n.github.io/post/rpc/","stats":{"text":"3 min read","time":145000,"words":646,"minutes":3},"isTop":false,"toc":"<ul class=\"markdownIt-TOC\">\n<li><a href=\"#rpc-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86\">RPC 基础知识</a>\n<ul>\n<li><a href=\"#%E5%BB%BA%E7%AB%8Brpc%E6%9C%8D%E5%8A%A1\">建立RPC服务</a></li>\n<li><a href=\"#rpc%E9%80%9A%E4%BF%A1%E7%9A%84%E5%9B%9B%E4%B8%AA%E9%98%B6%E6%AE%B5\">RPC通信的四个阶段</a>\n<ul>\n<li><a href=\"#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%E5%BB%BA%E7%AB%8Btcp%E9%80%9A%E4%BF%A1\">第一阶段：建立TCP通信</a></li>\n<li><a href=\"#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5rpc%E7%BB%91%E5%AE%9A\">第二阶段：RPC绑定</a><br>\n*\n<ul>\n<li><a href=\"#%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE\">通信协议</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5rpc%E5%8F%91%E7%8E%B0%E5%8F%8A%E6%9F%A5%E8%AF%A2\">第三阶段：RPC发现及查询</a>\n<ul>\n<li><a href=\"#epm-map%E6%98%A0%E5%B0%84%E8%AF%B7%E6%B1%82\">EPM MAP(映射)请求</a></li>\n<li><a href=\"#tcp-%E9%80%9A%E4%BF%A1%E7%BB%93%E6%9D%9F\">TCP 通信结束</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5rpc%E9%80%9A%E4%BF%A1\">第四阶段：RPC通信</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n","date":"2023-11-05 11:11:50","dateFormat":"2023-11-05"}],"tags":[{"name":"impacket","slug":"impacket","used":true,"link":"https://iceberg-n.github.io/tag/impacket/","count":7},{"name":"rpc","slug":"rpc","used":true,"link":"https://iceberg-n.github.io/tag/rpc/","count":8},{"name":"内网","slug":"nei-wang","used":true,"link":"https://iceberg-n.github.io/tag/nei-wang/","count":8}],"menus":[{"link":"https://iceberg-n.github.io","name":"首页","openType":"Internal"},{"link":"/archives","name":"归档","openType":"Internal"},{"link":"/tags","name":"标签","openType":"Internal"},{"link":"/post/about","name":"关于","openType":"Internal"}],"themeConfig":{"themeName":"pure","postPageSize":10,"archivesPageSize":50,"siteName":"Iceberg-N","siteDescription":"iceberg-N的网安之路","footerInfo":"","showFeatureImage":true,"domain":"https://iceberg-n.github.io","postUrlFormat":"SLUG","tagUrlFormat":"SLUG","dateFormat":"YYYY-MM-DD","feedFullText":true,"feedCount":10,"archivesPath":"archives","postPath":"post","tagPath":"tag"},"customConfig":{"APP_ID":"","APP_KEY":"","about":"","avatar":"","caf":"#84fab0","ccf":"#5f6169","ccs":"#999fa7","ctf":"#ffffff","cts":"#dddddd","customCss":"","descfriend":"","dribbble":"","facebook":"","friends":[],"ga":"","github":"","isEnabledCustomColor":false,"mermaid":false,"pageSize":"5","placeholder":"Just Go Go","recordIp":false,"skin":"black","twitter":"","vMaxWidth":"1000","vPadding":"2.5%","vPercentWidth":"100","valine":false,"visitor":false,"weibo":"","zhihu":""},"utils":{"now":1700038557646}}
